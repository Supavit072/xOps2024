## การ Implement Cluster ด้วย Proxmox

### การ Implement Cluster
การ Implement Cluster คือกระบวนการที่ใช้เครื่องเซิร์ฟเวอร์หลายเครื่องเข้าด้วยกันเพื่อทำงานร่วมกันในรูปแบบของ cluster โดยใช้ซอฟต์แวร์ Proxmox VE เพื่อจัดการ VM (Virtual Machine) และทรัพยากรต่างๆ บนเครื่องเซิร์ฟเวอร์เหล่านั้น

### Proxmox
Proxmox VE เป็นแพลตฟอร์มซอฟต์แวร์โอเพนซอร์สที่ใช้ในการจัดการเครื่องเซิร์ฟเวอร์และการสร้าง Virtual Machine (VM) โดยมีความสามารถในการสร้างและจัดการ Cluster อย่างมีประสิทธิภาพ

### การติดตั้ง Proxmox
![install_proxmox](/image/install_proxmox.png)
1. **การเตรียมเครื่องเซิร์ฟเวอร์**: ตรวจสอบว่าเครื่องเซิร์ฟเวอร์มีรายละเอียดที่เพียงพอสำหรับการติดตั้ง Proxmox VE
2. **การติดตั้ง Proxmox VE**: ดาวน์โหลดและติดตั้ง Proxmox VE บนเครื่องเซิร์ฟเวอร์ตามขั้นตอนการติดตั้งที่ระบุในเว็บไซต์ Proxmox
3. **การกำหนดค่าพื้นฐาน**: ติดตั้งและกำหนดค่าพื้นฐานเช่น IP Address, Hostname, DNS ให้กับ Proxmox VE
4. **การสร้าง Cluster**: ใช้ Proxmox VE Manager เพื่อสร้าง cluster และเพิ่มเครื่องเซิร์ฟเวอร์ที่ต้องการรวมเข้าใน cluster

### รายละเอียด Server VM Hypervisor ที่ควรรู้
- **Disk**: ควรมีพื้นที่จัดเก็บข้อมูลอย่างน้อย 128 GB สำหรับการติดตั้ง Proxmox VE
- **RAM**: ควรมี RAM ที่เพียงพอสำหรับการทำงานของ VMs ที่จะรันบนเครื่อง
- **CPU**: ควรมี CPU ที่มีความสามารถพอสำหรับการรัน VMs หลายๆ เครื่องพร้อมกัน

### การแบ่งแยกระบบเครื่องเซิร์ฟเวอร์
- สามารถแบ่งแยกระบบเครื่องเซิร์ฟเวอร์เป็นหลายๆ เครื่องและรวมเข้ากับ Cluster เพื่อเพิ่มประสิทธิภาพและความมั่นคงในการทำงาน
- หรือสามารถใช้เครื่องเซิร์ฟเวอร์เดียวและติดตั้ง Proxmox VE และ Cluster บนเครื่องเดียวกันได้ แต่อาจจะไม่มีความยืดหยุ่นในการจัดการทรัพยากรเท่ากับการใช้หลายเครื่อง

### เลือก Node สำหรับการสร้าง VM
![install_proxmox](/image/proxmox1.png)
เมื่อต้องการสร้าง VM บน Proxmox ในระบบ Cluster ที่มี Node ทั้งหมด 7 Node ดังนี้: pve081, pve082, pve083, pve084, pve085, pve086, pve087 คุณสามารถเลือก Node ที่เหมาะสมตามความเหมาะสมและความพร้อมของทรัพยากร โดยพิจารณาจากปัจจัยต่างๆ เช่น ประสิทธิภาพของฮาร์ดแวร์, การใช้งานของ VMs ที่มีอยู่บน Node นั้นๆ, และความต้องการของ VM ที่ต้องการสร้าง

### ขั้นตอนการสร้าง VM บน Proxmox
1. **การเข้าสู่ระบบ Proxmox**: เข้าสู่ระบบ Proxmox VE ผ่านเว็บเบราว์เซอร์โดยใช้ URL ของ Proxmox VE และข้อมูลการเข้าสู่ระบบที่ถูกต้อง
2. **การเลือก Node**: เลือก Node ที่ต้องการสร้าง VM โดยคลิกที่ชื่อ Node ในหน้าจอหลักของ Proxmox VE
3. **การสร้าง VM**: คลิกที่ "Create VM" หรือ "สร้าง VM" เพื่อเริ่มต้นกระบวนการสร้าง VM
4. **การตั้งค่า VM**:
   - **General**: ตั้งชื่อ VM, เลือก Group, และตั้งค่าการเชื่อมต่อ Console
   - **OS**: เลือก ISO ของระบบปฏิบัติการที่ต้องการติดตั้ง
![install_proxmox](/image/proxmox2.png)
   - **System**: กำหนดแหล่งทรัพยากร CPU, Memory, Disk, และ BIOS
   - **Disks**: กำหนดขนาดและประเภทของ Disk ที่จะใช้ใน VM
   - **CPU**: กำหนดจำนวน Core และความเร็วของ CPU
   - **Memory**: กำหนดปริมาณ Memory ที่ใช้ใน VM
   - **Network**: กำหนดการเชื่อมต่อ Network สำหรับ VM
   - **Confirm**: ตรวจสอบการตั้งค่าทั้งหมดและยืนยันการสร้าง VM

### การบูตแผ่นติดตั้ง Proxmox
1. เริ่มต้นโดยการบูตคอมพิวเตอร์จากแผ่นติดตั้ง Proxmox VE
2. เลือก "Install Proxmox VE" จากเมนูบูต
3. เลือกภาษาและติดตั้งตามขั้นตอนการติดตั้งที่แสดงบนหน้าจอ

### ตัวเลือก Hard Disk ในการติดตั้ง Proxmox
![install_proxmox](/image/proxmox3.png)
- **Filesystem**: 
    - **ext4**: เหมาะสำหรับใช้งานทั่วไป มีประสิทธิภาพดีในการทำงานและความเสถียร
    - **xfs**: เหมาะสำหรับการทำงานที่มีการอ่านและเขียนข้อมูลอย่างต่อเนื่อง
    - **zfs**: เหมาะสำหรับงานที่ต้องการความปลอดภัยและความน่าเชื่อถือสูงสุด มีความสามารถในการจัดการเรื่องการสำรองข้อมูลอย่างมีประสิทธิภาพ
    - **btrfs**: เหมาะสำหรับการทำงานที่ต้องการความเร็วในการสร้างสำรองข้อมูลและการควบคุมการใช้พื้นที่

- **Hard Disk Size (hdsize)**: ควรกำหนดขนาดของ Hard Disk ให้เหมาะสมกับความต้องการของระบบ โดยคำนึงถึงการเก็บข้อมูลและความต้องการของ VMs ที่จะสร้าง

- **Swap Size (swapsize)**: ควรกำหนดขนาดของ Swap Space ให้เหมาะสมกับปริมาณข้อมูลและการใช้งานของระบบ โดยทั่วไปแล้วควรกำหนดให้มีขนาดเท่ากับหรือเกินจากปริมาณของ Memory ของระบบ

- **Max Root (maxroot)**: กำหนดขนาดสูงสุดของ Root Partition ที่ Proxmox VE จะสามารถใช้งานได้

- **Min Free (minfree)**: กำหนดพื้นที่ขั้นต่ำที่ต้องเหลือว่างใน Hard Disk ที่ใช้เป็น Root Partition เพื่อป้องกันการเต็มพื้นที่

- **Max VZ (maxvz)**: กำหนดจำนวน VMs สูงสุดที่สามารถสร้างบน Hard Disk ได้

### คำแนะนำ
- คำนึงถึงความต้องการและการใช้งานของระบบเมื่อกำหนด Hard Disk Option
- ระมัดระวังในการกำหนดขนาดของ Hard Disk เพื่อป้องกันปัญหาของพื้นที่ไม่เพียงพอในอนาคต
- ตรวจสอบการกำหนดค่าทั้งหมดให้ถูกต้องก่อนที่จะดำเนินการติดตั้ง Proxmox VE
